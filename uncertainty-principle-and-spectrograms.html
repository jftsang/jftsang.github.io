
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="" />

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet/less" type="text/css" href="./theme/stylesheet/style.less">
    <script src="//cdnjs.cloudflare.com/ajax/libs/less.js/2.5.1/less.min.js" type="text/javascript"></script>

    <link id="dark-theme-style" rel="stylesheet" type="text/css"
    href="./theme/stylesheet/dark-theme.min.css">

    <link id="pygments-dark-theme" rel="stylesheet" type="text/css"
          href="./theme/pygments/monokai.min.css">



  <link rel="stylesheet" type="text/css" href="./theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="./theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="./theme/font-awesome/css/solid.css">




  <link href="https://jmft.dev/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="JMFT Atom">




<meta name="author" content="J. M. F. Tsang" />
<meta name="description" content="In the previous post I discussed how, when measuring the frequency (tempo) of a signal that itself changes in time, there is necessarily a tradeoff between the precision in the measured frequency and precision in the time at which the measurement is taken: A more precise measurement of frequency requires …" />
<meta name="keywords" content="physics, quantum-mechanics, music, teaching">


  <meta property="og:site_name" content="JMFT"/>
  <meta property="og:title" content="The uncertainty principle and spectrograms"/>
  <meta property="og:description" content="In the previous post I discussed how, when measuring the frequency (tempo) of a signal that itself changes in time, there is necessarily a tradeoff between the precision in the measured frequency and precision in the time at which the measurement is taken: A more precise measurement of frequency requires …"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="./uncertainty-principle-and-spectrograms.html"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2024-01-09 00:00:00+00:00"/>
  <meta property="article:modified_time" content=""/>
  <meta property="article:author" content="./author/j-m-f-tsang.html">
  <meta property="article:section" content="Physics"/>
  <meta property="article:tag" content="physics"/>
  <meta property="article:tag" content="quantum-mechanics"/>
  <meta property="article:tag" content="music"/>
  <meta property="article:tag" content="teaching"/>
  <meta property="og:image" content="">

  <title>JMFT &ndash; The uncertainty principle and spectrograms</title>



    <link rel="stylesheet" href="https://unpkg.com/@highlightjs/cdn-assets@11.9.0/styles/github-dark.min.css">
    <script src="https://unpkg.com/@highlightjs/cdn-assets@11.9.0/highlight.min.js"></script>
    <script src="https://unpkg.com/@highlightjs/cdn-assets@11.9.0/languages/python.min.js"></script>
    <script>hljs.highlightAll();</script>

    <script id="MathJax-script" async
            src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js">
    </script>
    <script>
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$']]
        }
      };
    </script>
</head>
<body class="dark-theme">

<aside>
  <div>
    <a href="./">
      <img src="./theme/img/profile.png" alt="" title="">
    </a>

    <h1>
      <a href="./"></a>
    </h1>



    <nav>
      <ul class="list">


            <li>
              <a target="_self"
                 href="./pages/about.html#about">
                About
              </a>
            </li>
            <li>
              <a target="_self"
                 href="./pages/cv.html#cv">
                CV
              </a>
            </li>
            <li>
              <a target="_self"
                 href="./pages/music.html#music">
                Music
              </a>
            </li>
            <li>
              <a target="_self"
                 href="./pages/software.html#software">
                Software
              </a>
            </li>
            <li>
              <a target="_self"
                 href="./pages/teaching.html#teaching">
                Teaching
              </a>
            </li>
      </ul>
    <div class="flex"></div>
    <div>
      <ul class="list">
          <li>
            <a target="_self" href="/categories.html" >Categories</a>
          </li>
          <li>
            <a target="_self" href="/tags.html" >Tags</a>
          </li>
          <li>
            <a target="_self" href="https://elderberri.es/" >Hamster</a>
          </li>
      </ul>
    </div>
    </nav>

    <ul class="social">
      <li>
        <a class="sc-at"
rel="me"           href="mailto:j_dot_m_dot_f_dot_tsang_at_cantab_dot_net"
           target="_blank">
          <i class="fa-solid fa-at"></i>
        </a>
      </li>
      <li>
        <a class="sc-bluesky"
           href="https://bsky.app/profile/jmft.dev"
           target="_blank">
          <i class="fa-brands fa-bluesky"></i>
        </a>
      </li>
      <li>
        <a class="sc-linkedin"
           href="https://www.linkedin.com/in/joanna-tsang-bb2059171/"
           target="_blank">
          <i class="fa-brands fa-linkedin"></i>
        </a>
      </li>
      <li>
        <a class="sc-github"
           href="https://github.com/jftsang"
           target="_blank">
          <i class="fa-brands fa-github"></i>
        </a>
      </li>
    </ul>
  </div>

</aside>
  <main>


<article class="single">
  <header>
      
    <h1 id="uncertainty-principle-and-spectrograms">The uncertainty principle and spectrograms</h1>
    <p>
      Posted on Tue 09 January 2024 in <a href="./category/physics.html">Physics</a>

    </p>
  </header>


  <div>
    <p>In the <a href="uncertainty-principle-obvious-to-musicians">previous post</a> I discussed how, when measuring the frequency (tempo) of a signal that itself changes in time, there is necessarily a tradeoff between the precision in the measured frequency and precision in the time at which the measurement is taken: A more precise measurement of frequency requires that the sample be taken over a longer period of time. This is particularly well demonstrated in signal processing and spectrograms.</p>
<h2>Fourier decomposition</h2>
<p>Recall first of all that any signal can be decomposed into its frequency components: this is the Fourier transform. Pure tones, which consist of a single frequency component, are given by sine waves. Most instruments do not produce pure tones when they play a note; instead, they play a mixture of tones, which together give the unique timbre of the instrument.</p>
<p>For example, this is an A5 played on an alto recorder:
<audio src="static/APlayedOnTrebleRecorder.wav" controls></audio></p>
<p>Its spectrum, given by taking a Fourier transform of the signal, looks like this [[ref]By convention, both axes are drawn on logarithmic scales. The relative amplitudes are measured in <a href="https://en.wikipedia.org/wiki/Decibel">decibels</a>, a logarithmic unit; 0 dB corresponds to the maximum amplitude that can be represented by the file format.[/ref]]:</p>
<p><img src="images/SpectrumOfRecorderA5.png" alt="" /></p>
<p>Spectrum of the recorder. Note the log scales.</p>
<p>The spectrum consists of a peak around f = 880 Hz (slightly lower in this example), which is the fundamental frequency for A5, along with further, smaller peaks, at integer multiples of f = 880 Hz ('overtones' or 'harmonics'). The overall sound is periodic with frequency 880 Hz, giving a tonal sound.</p>
<h2>Varying pitch</h2>
<p>Most music consists of more than one note. [[ref]<a href="https://www.youtube.com/watch?v=AWVUp12XPpU">John Cage might disagree.</a>[/ref]]</p>
<p><audio src="static/FrereJacque.wav" controls></audio></p>
<p>If you wanted to analyse the notes in that track, taking the Fourier transform of the entire track is not particularly interesting.</p>
<p><img src="images/SpectrumOfMelody.png" alt="" /></p>
<p>Spectrum of the entire recording.</p>
<p>This spectrogram contains contributions from <em>all</em> the notes in the track. This is like measuring pulse by sampling the heartbeat over a whole day: it gives no information about the pulse at any given time. This playthrough was in F major; some notes (F and C) were played more often than other notes, so there are still peaks at those notes, but all other detail has been lost.</p>
<p>It is much more useful to work with the <a href="https://en.wikipedia.org/wiki/Short-time_Fourier_transform">short-time Fourier transform</a> (STFT). At each timestep, take a Fourier transform of the part of the signal around that time. [[ref]To avoid edge effects, a window function is usually applied to smooth the signal. Audacity uses the Hann window by default, SciPy uses Tukey. The <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.get_window.html">SciPy docs</a> have many other examples.[/ref]] The STFT is a function of both time and frequency, so it is usually visualised as a spectrogram:</p>
<p><img src="images/SpectrogramOfMelody.png" alt="" /></p>
<p>Spectrogram of the above recording (window size 2048 with Hann smoothing). Time on the horizontal axis, frequency (logarithmic) on the vertical axis, colour intensity for amplitude.</p>
<p>As seen, each note consists of an intense fundamental frequency alongside a stack of harmonics.</p>
<p>As with the pulse measurement procedure in the last post, the length of the window over which the spectrogram is taken is a free parameter. The effect of this parameter is very well illustrated by the following example.</p>
<h2>Two tones</h2>
<p>Consider a signal consisting of a 1 second tone at 400 Hz followed by a 1 second tone at 800 Hz. The signal is sampled at 16 kHz.</p>
<p><audio src="static/TwoTones.wav" controls></audio></p>
<p>The waveform is a sine wave for 0 &lt; t &lt; 1, and a higher-frequency sine wave for 1 &lt; t &lt; 2. For simplicity, the phases are aligned so that the wave is continuous at t = 1.</p>
<p><img src="images/TwoToneSignal.png" alt="" /></p>
<p>The spectrograms when the window size is 256, 1024 and 4096 (with Tukey smoothing). These correspond to intervals of 16 ms, 64 ms and 256 ms respectively.</p>
<p><img src="images/TwoToneSpectrograms.png" alt="" /></p>
<p>Spectrograms of the two tones for window sizes 256, 1024, 4096</p>
<p>The tradeoff between precision in frequency and precision in time is now very visible.</p>
<p>Away from the transition at t = 1, the larger the window for the STFT the more precise the estimate for frequency will be: thus the first spectrogram contains wide bands, since the narrowest window spans only about 6 periods, while the last spectrogram has thinnest bands since the widest window spans over 100 periods.</p>
<p>However, near t = 1, the window for the STFT contains samples from both t &lt; 1 (at 400 Hz) and from t &gt; 1 (at 800 Hz), so the computed STFT contains components from both. The region that is affected by this is largest for the widest window. Thus, a STFT with a wider window does a poorer job of detecting the time at which a frequency transition occurs.</p>

  </div>
  <div class="tag-cloud">
    <p>
      <a href="./tag/physics.html">physics</a>
      <a href="./tag/quantum-mechanics.html">quantum-mechanics</a>
      <a href="./tag/music.html">music</a>
      <a href="./tag/teaching.html">teaching</a>
    </p>
  </div>






</article>

<footer>
<p>&copy;  </p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
</p></footer>  </main>

<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " JMFT ",
  "url" : ".",
  "image": "",
  "description": "Thoughts on software engineering, physics, teaching and music."
}
</script>
</body>
</html>