
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="" />

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet/less" type="text/css" href="./theme/stylesheet/style.less">
    <script src="//cdnjs.cloudflare.com/ajax/libs/less.js/2.5.1/less.min.js" type="text/javascript"></script>

    <link id="dark-theme-style" rel="stylesheet" type="text/css"
    href="./theme/stylesheet/dark-theme.min.css">

    <link id="pygments-dark-theme" rel="stylesheet" type="text/css"
          href="./theme/pygments/monokai.min.css">



  <link rel="stylesheet" type="text/css" href="./theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="./theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="./theme/font-awesome/css/solid.css">




  <link href="https://jmft.dev/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="JMFT Atom">




<meta name="author" content="J. M. F. Tsang" />
<meta name="description" content="This website is now self-hosted on a Raspberry Pi server at home. I had struggled with nginx and HTTPS in the past, so was rather pleasantly surprised to see how straightforward it was. I couldn&#39;t find anything on the web that walked one through the whole process, so here are …" />
<meta name="keywords" content="backend, nginx, https">


  <meta property="og:site_name" content="JMFT"/>
  <meta property="og:title" content="Self-hosting a minimal website with nginx and HTTPS"/>
  <meta property="og:description" content="This website is now self-hosted on a Raspberry Pi server at home. I had struggled with nginx and HTTPS in the past, so was rather pleasantly surprised to see how straightforward it was. I couldn&#39;t find anything on the web that walked one through the whole process, so here are …"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="./setting-up-nginx-and-https.html"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2024-04-27 00:00:00+01:00"/>
  <meta property="article:modified_time" content=""/>
  <meta property="article:author" content="./author/j-m-f-tsang.html">
  <meta property="article:section" content="Software"/>
  <meta property="article:tag" content="backend"/>
  <meta property="article:tag" content="nginx"/>
  <meta property="article:tag" content="https"/>
  <meta property="og:image" content="">

  <title>JMFT &ndash; Self-hosting a minimal website with nginx and HTTPS</title>



    <link rel="stylesheet" href="https://unpkg.com/@highlightjs/cdn-assets@11.9.0/styles/github-dark.min.css">
    <script src="https://unpkg.com/@highlightjs/cdn-assets@11.9.0/highlight.min.js"></script>
    <script src="https://unpkg.com/@highlightjs/cdn-assets@11.9.0/languages/python.min.js"></script>
    <script>hljs.highlightAll();</script>

    <script id="MathJax-script" async
            src="https://cdn.jsdelivr.net/npm/mathjax@4/tex-mml-chtml.js">
    </script>
    <script>
      window.MathJax = {
        tex: {
          inlineMath: [['$', '$']]
        }
      };
    </script>
</head>
<body class="dark-theme">

<aside>
  <div>
    <a href="./">
      <img src="./theme/img/profile.png" alt="" title="">
    </a>

    <h1>
      <a href="./"></a>
    </h1>



    <nav>
      <ul class="list">


            <li>
              <a target="_self"
                 href="./pages/about.html#about">
                About
              </a>
            </li>
            <li>
              <a target="_self"
                 href="./pages/cv.html#cv">
                CV
              </a>
            </li>
            <li>
              <a target="_self"
                 href="./pages/music.html#music">
                Music
              </a>
            </li>
            <li>
              <a target="_self"
                 href="./pages/software.html#software">
                Software
              </a>
            </li>
            <li>
              <a target="_self"
                 href="./pages/teaching.html#teaching">
                Teaching
              </a>
            </li>
      </ul>
    <div class="flex"></div>
    <div>
      <ul class="list">
          <li>
            <a target="_self" href="/categories.html" >Categories</a>
          </li>
          <li>
            <a target="_self" href="/tags.html" >Tags</a>
          </li>
          <li>
            <a target="_self" href="https://elderberri.es/" >Hamster</a>
          </li>
      </ul>
    </div>
    </nav>

    <ul class="social">
      <li>
        <a class="sc-at"
rel="me"           href="mailto:j_dot_m_dot_f_dot_tsang_at_cantab_dot_net"
           target="_blank">
          <i class="fa-solid fa-at"></i>
        </a>
      </li>
      <li>
        <a class="sc-twitter"
           href="https://bsky.app/profile/jmft.dev"
           target="_blank">
          <i class="fa-brands fa-twitter"></i>
        </a>
      </li>
      <li>
        <a class="sc-linkedin"
           href="https://www.linkedin.com/in/joanna-tsang-bb2059171/"
           target="_blank">
          <i class="fa-brands fa-linkedin"></i>
        </a>
      </li>
      <li>
        <a class="sc-github"
           href="https://github.com/jftsang"
           target="_blank">
          <i class="fa-brands fa-github"></i>
        </a>
      </li>
    </ul>
  </div>

</aside>
  <main>


<article class="single">
  <header>
      
    <h1 id="setting-up-nginx-and-https">Self-hosting a minimal website with nginx and HTTPS</h1>
    <p>

      Posted on Sat 27 April 2024 in <a href="./category/software.html">Software</a>

    </p>
  </header>


  <div>
    <p>This website is now self-hosted on a Raspberry Pi server at home. I had
struggled with nginx and HTTPS in the past, so was rather pleasantly
surprised to see how straightforward it was.</p>
<p>I couldn't find anything on the web that walked one through the whole
process, so here are the steps that I took, in some order. (This isn't
meant to be a full tutorial, sorry.)</p>
<p>The site now serves static content using
<a href="https://getpelican.com">Pelican</a>. Much nicer than WordPress. More on
Pelican in a future post, but for now let us take it for granted that we
just want to serve static files in <code>/home/jmft2/jmft.dev/public_html</code>.</p>
<h2>DNS and firewall</h2>
<ul>
<li>Add a suitable DNS record to your home network. I use
<a href="https://noip.com">No-IP</a> and then use an ALIAS record.</li>
<li>Set up port forwarding on ports 80 and 443 on your firewall (in your
router settings).</li>
</ul>
<h2>Setting up nginx</h2>
<ul>
<li>Install nginx:</li>
</ul>
<pre><code class="language-bash">sudo apt install nginx
</code></pre>
<ul>
<li>Create a minimal config file at <code>~/jmft.dev/nginx_config</code>:</li>
</ul>
<pre><code>server {
    server_name jmft.dev;

    access_log /home/jmft2/jmft.dev/logs/nginx-access.log;
    error_log /home/jmft2/jmft.dev/logs/nginx-error.log;

    location / {
        alias /home/jmft2/jmft.dev/public_html/;
        index index.html;
    }
}
</code></pre>
<ul>
<li>Make the directory for logs:</li>
</ul>
<pre><code>mkdir ~/jmft.dev/logs
</code></pre>
<ul>
<li>Make symlinks to the <code>sites-available</code> and <code>sites-enabled</code> directories
in <code>/etc/nginx</code>:</li>
</ul>
<pre><code class="language-bash">sudo ln -s ~/jmft.dev/nginx_config /etc/nginx/sites-available/jmft.dev
sudo ln -s /etc/nginx/sites-available/jmft.dev /etc/nginx/sites-enabled/jmft.dev
</code></pre>
<ul>
<li>Make sure the <code>public_html</code> directory <em>and all its parents</em> are
readable by the <code>www-data</code> user. One way is this:</li>
</ul>
<pre><code class="language-bash">chmod a+rX ~ ~/jmft.dev ~/jmft.dev/public_html
</code></pre>
<ul>
<li>Check the configuration, and if it is successful, load it:</li>
</ul>
<pre><code class="language-bash">sudo nginx -t &amp;&amp; sudo systemctl reload nginx
</code></pre>
<p>At this point, going to <code>http://jmft.dev</code> (no https) should show you the
<code>index.html</code> page for the site.</p>
<h2>Setting up HTTPS</h2>
<p>LetsEncrypt recommend using <a href="https://certbot.eff.org/">Certbot</a>, which
made the HTTPS installation process very straightforward.</p>
<ul>
<li>Certbot is managed by the Snap package manager, so it is first
necessary to install that:</li>
</ul>
<pre><code class="language-bash">sudo apt install snapd
sudo systemctl restart snapd  # might be needed
sudo snap install core
sudo snap install --classic certbot
</code></pre>
<ul>
<li>Run Certbot and follow the instructions:</li>
</ul>
<pre><code class="language-bash">sudo certbox --nginx
</code></pre>
<ul>
<li>Reload the new nginx configurations:</li>
</ul>
<pre><code class="language-bash">sudo systemctl reload nginx
</code></pre>
<p>With this set up, going to <code>https://jmft.dev</code> should bring the site up.</p>

  </div>
  <div class="tag-cloud">
    <p>
      <a href="./tag/backend.html">backend</a>
      <a href="./tag/nginx.html">nginx</a>
      <a href="./tag/https.html">https</a>
    </p>
  </div>






</article>

<footer>
<p>&copy;  </p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
</p></footer>  </main>

<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " JMFT ",
  "url" : ".",
  "image": "",
  "description": "Thoughts on software engineering, physics, teaching and music."
}
</script>
</body>
</html>